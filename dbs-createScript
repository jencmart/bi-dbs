~-- Generated by Oracle SQL Developer Data Modeler 4.2.0.932
--   at:        2017-05-07 22:49:02 CEST
--   site:      Oracle Database 11g
--   type:      Oracle Database 11g

set echo on
CREATE OR REPLACE PROCEDURE "ZRUS_ALL_OBJEKTY_SCHEMATU" AS
-- pokud v logu bude uvedeno, ze nektery objekt nebyl zrusen, protoze na nej jiny jeste existujici objekt stavi,
-- spust proceduru opakovane, dokud se nezrusi vse
v_pom PLS_INTEGER;
BEGIN
LOOP
FOR irec IN (SELECT DISTINCT
                    object_type,object_name,
                    'drop '||object_type||' "'||object_name||'"'||
                    CASE object_type WHEN 'TABLE' THEN ' cascade constraints purge'
                                     ELSE ' '
                    END AS prikaz
              FROM user_objects
              WHERE object_name <> 'ZRUS_ALL_OBJEKTY_SCHEMATU'
            )
  LOOP
   BEGIN
   DBMS_OUTPUT.put_line('prikaz '||irec.prikaz);
      EXECUTE IMMEDIATE irec.prikaz;
   EXCEPTION
      WHEN OTHERS THEN DBMS_OUTPUT.put('nen? ');
   END;
   DBMS_OUTPUT.put_line('zrusen(a) '||irec.object_type||' '||irec.object_name);
  END LOOP;
SELECT COUNT(*) INTO v_pom
FROM user_objects
WHERE object_name <> 'ZRUS_ALL_OBJEKTY_SCHEMATU';
EXIT WHEN v_pom = 0;
END LOOP;
DBMS_OUTPUT.put_line('hotovo!');
END ZRUS_ALL_OBJEKTY_SCHEMATU;
/
execute ZRUS_ALL_OBJEKTY_SCHEMATU
/*
DROP TABLE ADRESA CASCADE CONSTRAINTS PURGE
;
DROP TABLE ALERGEN CASCADE CONSTRAINTS PURGE
;
DROP TABLE AUTOMOBIL CASCADE CONSTRAINTS PURGE
;
DROP TABLE KOLO CASCADE CONSTRAINTS PURGE
;
DROP TABLE LOKALITA CASCADE CONSTRAINTS PURGE
;
DROP TABLE MANAGER CASCADE CONSTRAINTS PURGE
;
DROP TABLE MESTO CASCADE CONSTRAINTS PURGE
;
DROP TABLE OBJ_POLOZKA CASCADE CONSTRAINTS PURGE
;
DROP TABLE OBJEDNAVKA CASCADE CONSTRAINTS PURGE
;
DROP TABLE OBSAHUJE CASCADE CONSTRAINTS PURGE
;
DROP TABLE POLOZKA CASCADE CONSTRAINTS PURGE
;
DROP TABLE POSLICEK CASCADE CONSTRAINTS PURGE
;
DROP TABLE ZAKAZNIK CASCADE CONSTRAINTS PURGE
; */


CREATE TABLE animal (
    animal_id       INTEGER NOT NULL,
    name            VARCHAR2(50 CHAR),
    parent_name     VARCHAR2(50 CHAR),
    zookeeper_id    INTEGER NOT NULL
);
ALTER TABLE animal ADD CONSTRAINT animal_pk PRIMARY KEY ( animal_id );

CREATE TABLE zookeeper (
    zookeeper_id    INTEGER NOT NULL,
    name            VARCHAR2(50 CHAR),
    surname         VARCHAR2(50 CHAR),
    address_id      INTEGER NOT NULL
);
ALTER TABLE zookeeper ADD CONSTRAINT zookeeper_pk PRIMARY KEY ( zookeeper_id );


CREATE TABLE address (
    address_id      INTEGER NOT NULL,
    street          VARCHAR2(50 CHAR),
    town            VARCHAR2(50 CHAR)
);
ALTER TABLE address ADD CONSTRAINT address_pk PRIMARY KEY ( address_id );



ALTER TABLE animal ADD CONSTRAINT animal_zookeeper_fk FOREIGN KEY ( zookeeper_id )
    REFERENCES zookeeper ( zookeeper_id );

ALTER TABLE zookeeper ADD CONSTRAINT zookeeper_address_fk FOREIGN KEY ( address_id )
    REFERENCES address ( address_id );



-- Oracle SQL Developer Data Modeler Summary Report: 
-- 
-- CREATE TABLE                            15
-- CREATE INDEX                             0
-- ALTER TABLE                             30
-- CREATE VIEW                              0
-- ALTER VIEW                               0
-- CREATE PACKAGE                           0
-- CREATE PACKAGE BODY                      0
-- CREATE PROCEDURE                         0
-- CREATE FUNCTION                          0
-- CREATE TRIGGER                           0
-- ALTER TRIGGER                            0
-- CREATE COLLECTION TYPE                   0
-- CREATE STRUCTURED TYPE                   0
-- CREATE STRUCTURED TYPE BODY              0
-- CREATE CLUSTER                           0
-- CREATE CONTEXT                           0
-- CREATE DATABASE                          0
-- CREATE DIMENSION                         0
-- CREATE DIRECTORY                         0
-- CREATE DISK GROUP                        0
-- CREATE ROLE                              0
-- CREATE ROLLBACK SEGMENT                  0
-- CREATE SEQUENCE                          0
-- CREATE MATERIALIZED VIEW                 0
-- CREATE SYNONYM                           0
-- CREATE TABLESPACE                        0
-- CREATE USER                              0
-- 
-- DROP TABLESPACE                          0
-- DROP DATABASE                            0
-- 
-- REDACTION POLICY                         0
-- 
-- ORDS DROP SCHEMA                         0
-- ORDS ENABLE SCHEMA                       0
-- ORDS ENABLE OBJECT                       0
-- 
-- ERRORS                                   0
-- WARNINGS                                 0


